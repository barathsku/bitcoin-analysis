version: 2

models:
  - name: fct_rolling_metrics
    description: "Fact table with rolling performance metrics"
    columns:
      - name: asset_id
        description: "Asset identifier"
        tests:
          - not_null
      - name: data_date
        description: "Calculation date"
        tests:
          - not_null
      - name: volatility_30d
        description: "30-day rolling volatility"

  - name: rpt_performance_summary
    description: "Performance summary showing asset returns across multiple time windows compared to Bitcoin"
    columns:
      - name: asset_id
        description: "Asset identifier"
        tests:
          - not_null
      - name: period
        description: "Time period (7D, 1M, 3M, 6M, YTD, 1Y)"
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['7D', '1M', '3M', '6M', 'YTD', '1Y']
      - name: return_pct
        description: "Total return percentage for the period"
      - name: vs_btc_status
        description: "Whether asset outperformed, matched, or underperformed BTC"
        tests:
          - accepted_values:
              arguments:
                values: ['Outperformed', 'Matched', 'Underperformed']

  - name: rpt_investment_simulation
    description: "Investment simulation comparing $1K lump sum vs $100/month DCA strategy"
    columns:
      - name: asset
        description: "Asset (USD or BTC)"
        tests:
          - not_null
      - name: strategy
        description: "Investment strategy (Lump Sum or DCA)"
        tests:
          - not_null
      - name: initial_investment_usd
        description: "Total amount invested in USD"
        tests:
          - not_null
      - name: current_value_usd
        description: "Current portfolio value in USD"
        tests:
          - not_null

  - name: rpt_volatility_comparison
    description: "Volatility analysis comparing daily and annualized volatility across assets"
    columns:
      - name: asset_id
        description: "Asset identifier"
        tests:
          - not_null
          - unique
      - name: daily_volatility_pct
        description: "Standard deviation of daily returns (percentage)"
        tests:
          - not_null
      - name: annualized_volatility_pct
        description: "Annualized volatility (percentage)"
        tests:
          - not_null

  - name: rpt_correlation
    description: "Correlation matrix of asset returns"
    columns:
      - name: asset_a
        description: "First asset in the pair"
        tests:
          - not_null
      - name: asset_b
        description: "Second asset in the pair"
        tests:
          - not_null
      - name: correlation
        description: "Pearson correlation coefficient"
        tests:
          - not_null
